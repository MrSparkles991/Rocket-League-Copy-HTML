<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Minecraft 2D</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
body {
    margin: 0;
    background: #87CEEB;
    overflow: hidden;
}
canvas {
    display: block;
    image-rendering: pixelated;
}
#ui {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
}
.btn {
    width: 60px;
    height: 60px;
    background: rgba(0,0,0,0.4);
    color: white;
    font-size: 20px;
    border-radius: 10px;
    text-align: center;
    line-height: 60px;
    user-select: none;
}
</style>
</head>
<body>

<canvas id="game"></canvas>

<div id="ui">
    <div class="btn" id="left">◀</div>
    <div class="btn" id="jump">▲</div>
    <div class="btn" id="right">▶</div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

const TILE = 32;
const WORLD_W = 200;
const WORLD_H = 100;

/* ===== TEXTURAS ===== */
const textures = {
    grass: "#3CB043",
    dirt: "#8B4513",
    stone: "#777"
};

/* ===== MUNDO ===== */
const world = [];
for (let y = 0; y < WORLD_H; y++) {
    world[y] = [];
    for (let x = 0; x < WORLD_W; x++) {
        if (y > 50) world[y][x] = "stone";
        else if (y === 50) world[y][x] = "grass";
        else if (y > 45) world[y][x] = "dirt";
        else world[y][x] = null;
    }
}

/* ===== PLAYER (STEVE 2D) ===== */
const player = {
    x: 100,
    y: 0,
    w: 24,
    h: 32,
    vx: 0,
    vy: 0,
    onGround: false
};

/* ===== INPUT ===== */
const keys = {};
addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

/* ===== MOBILE ===== */
document.getElementById("left").ontouchstart = () => keys["a"] = true;
document.getElementById("left").ontouchend = () => keys["a"] = false;
document.getElementById("right").ontouchstart = () => keys["d"] = true;
document.getElementById("right").ontouchend = () => keys["d"] = false;
document.getElementById("jump").ontouchstart = () => {
    if (player.onGround) player.vy = -10;
};

/* ===== MOUSE ===== */
canvas.addEventListener("mousedown", e => {
    const wx = Math.floor((e.clientX + camX) / TILE);
    const wy = Math.floor((e.clientY + camY) / TILE);
    if (e.button === 0) world[wy][wx] = null;
});
canvas.addEventListener("contextmenu", e => {
    e.preventDefault();
    const wx = Math.floor((e.clientX + camX) / TILE);
    const wy = Math.floor((e.clientY + camY) / TILE);
    world[wy][wx] = "dirt";
});

/* ===== CÂMERA ===== */
let camX = 0, camY = 0;

/* ===== COLISÃO ===== */
function solid(x, y) {
    return world[y] && world[y][x];
}

/* ===== LOOP ===== */
function update() {
    /* MOVIMENTO */
    if (keys["a"]) player.vx = -3;
    else if (keys["d"]) player.vx = 3;
    else player.vx *= 0.8;

    if (keys["w"] && player.onGround) player.vy = -10;

    player.vy += 0.5;

    /* X */
    player.x += player.vx;
    if (solid(Math.floor(player.x / TILE), Math.floor(player.y / TILE)))
        player.x -= player.vx;

    /* Y */
    player.y += player.vy;
    if (solid(Math.floor(player.x / TILE), Math.floor((player.y + player.h) / TILE))) {
        player.y = Math.floor((player.y + player.h) / TILE) * TILE - player.h;
        player.vy = 0;
        player.onGround = true;
    } else player.onGround = false;

    /* CÂMERA */
    camX = player.x - canvas.width / 2;
    camY = player.y - canvas.height / 2;

    draw();
    requestAnimationFrame(update);
}

/* ===== DESENHO ===== */
function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    /* BLOCO */
    for (let y = 0; y < WORLD_H; y++) {
        for (let x = 0; x < WORLD_W; x++) {
            if (world[y][x]) {
                ctx.fillStyle = textures[world[y][x]];
                ctx.fillRect(x*TILE - camX, y*TILE - camY, TILE, TILE);
                ctx.strokeStyle = "rgba(0,0,0,0.2)";
                ctx.strokeRect(x*TILE - camX, y*TILE - camY, TILE, TILE);
            }
        }
    }

    /* STEVE */
    ctx.fillStyle = "#00A2FF"; // camisa
    ctx.fillRect(player.x - camX, player.y - camY + 12, player.w, 20);
    ctx.fillStyle = "#F1C27D"; // cabeça
    ctx.fillRect(player.x - camX, player.y - camY, player.w, 12);
    ctx.fillStyle = "#1E1E1E"; // pernas
    ctx.fillRect(player.x - camX, player.y - camY + 32, player.w, 8);
}

update();
</script>
</body>
</html>
